
<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input-container.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/iron-input/iron-input.html">

<link rel="import" href="../sound-waveform/sound-waveform.html">


<!--
A sound editor.

Example:

<sound-editor></sound-editor>

@element sound-editor
-->
<dom-module id="sound-editor">

	<style>
		:host {
			background-color: white;
			/*background-color: #AADBFC;*/
			font-family: 'Roboto', 'Noto', sans-serif;
			-webkit-font-smoothing: antialiased;
		}

		#dialog{
			border-radius: 5px;
			width: 50vw;
			height: 50vh;
		}

		.top {
			height: 5%;
			color: #212121;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.toplable{
			text-align: center;
			flex-basis: 100%;
		}

		.topicon{
			position: absolute;
			top: 6%;
			left: 90%;
			--iron-icon-height: 16px;
			--iron-icon-width: 16px;
			fill: grey;
			visibility: hidden;

		}

		.middle {
			border-top: 1px solid black;
			border-bottom: 1px solid black;
			padding: 0;
			height: 60%;
			width: 100%;
			position: relative;
		}

		.bottom {
			height: 5%;
			width: 100%;
			color: #212121;
			text-align: center;
			font-size: 2em;
		}

		paper-input-container {
			--paper-input-container-underline: {
				display: none;
			}
			;
			--paper-input-container-underline-focus: {
				display: none;
			}
			text-align: center;

			'Noto',
			sans-serif;
			-webkit-font-smoothing: antialiased;
		}

		#savebutton{
			--iron-icon-height: 20px;
    	--iron-icon-width: 20px;
		}

		iron-icon:hover {
			cursor: pointer;
		}

		.top:hover .topicon{
			visibility: visible;
		}

	</style>

	<template>
		<paper-dialog id="dialog" modal >
			<div class="top">
				<paper-input-container class="toplable"  no-label-float>
					<label>sound name</label>
					<input is="iron-input" id="input" bind-value="{{soundname}}">
				</paper-input-container>
				<iron-icon class="topicon" id="savebutton" icon="icons:save" title="edit" on-click="close"></iron-icon>
			</div>
			<div class="middle">
				<sound-waveform id="waveplayer" src="{{src}}"></sound-waveform>
			</div>
			<paper-input-container no-label-float>
				<label>key</label>
				<input is="iron-input" id="keyname" bind-value="{{key}}">
			</paper-input-container>
		</paper-dialog>
	</template>

</dom-module>

<script>
	(function() {
		'use strict';

		var MODE = {
			EDIT: 'edit',
			PLAY: 'play'
		};

		Polymer({

			is: 'sound-editor',

			properties: {
				key: {
					type: String,
					value: '',
					observer: '_onKeyChange'
				},

				soundname: {
					type: String,
					value: ''
				},

				keyCode: {
					type: Number,
					value: 0
				},

				mode: {
					type: String,
					value: MODE.PLAY
				},

				src: {
					type: Object,
				}
			},

			ready: function() {

			},

			open: function(detail) {
				console.log(detail);
				this.soundname = detail.soundname;
				this.src = detail.src;
				this.key = detail.key;
				this._buttonIndex = detail.buttonIndex;
				this.$.dialog.open();
			},

			close: function() {
				this.$.dialog.close();
				this.fire('save', {
					buttonIndex: this._buttonIndex
				});
			},

			_onKeyChange: function(newValue) {
				if (newValue) {
					if (newValue.length > 1) {
						this.key = newValue.charAt(newValue.length - 1);
					} else {
						this.keyCode = keycode(newValue);
					}
				}
			}
		});
	})();
</script>
